<template>
  <div class="slds-box slds-box_x-small slds-m-top_x-small">
    <template if:true={isEditMode}>
      <h2>{label.edit_question_form_title}</h2>
    </template>

    <template if:false={isEditMode}>
      <h2>{label.create_question_form_title}</h2>
    </template>

    <lightning-input
      class="input"
      type="text"
      label={label.specify_question}
      onchange={handleLabel}
      value={question.Label__c}
    ></lightning-input>

    <div class="slds-grid slds-wrap">
      <div class="slds-size_1-of-2">
        <lightning-radio-group
          name="radioGroup"
          label={label.type}
          options={displayedTypes}
          value={selectedType}
          type="radio"
          onchange={handleTypeChange}
        >
        </lightning-radio-group>
      </div>

      <div class="slds-size_1-of-2">
        <lightning-checkbox-group
          name="settings"
          label={label.question_settings}
          options={questionSettingList}
          value={selectedSettings}
          onchange={handleSettingChange}
        >
        </lightning-checkbox-group>
      </div>
    </div>

    <template if:true={isOptionsEnabled}>
      <div class="slds-m-top_xx-small">
        <h2>Specify Question Options</h2>
        <ul class="slds-listbox slds-listbox_vertical" role="presentation">
          <template for:each={question.Question_Options__r} for:item="option">
            <li key={option.Id} role="presentation" class="slds-listbox__item">
              <c-option-list-element
                option={option}
                ondelete={deleteOption}
                onedit={editOption}
              ></c-option-list-element>
            </li>
          </template>
        </ul>

        <div class="lgc-bg slds-wrap">
          <lightning-input
            class="option-input"
            type="text"
            label={label.enter_option_value}
          ></lightning-input>

          <template if:true={isEditOption}>
            <lightning-button
              label={label.save_changes}
              class="slds-m-top_x-small slds-m-bottom_x-small slds-float_right"
              onclick={saveOptionChanges}
            ></lightning-button>
            <lightning-button
              variant="destructive-text"
              label={label.cancel_edit}
              onclick={cancelOptionEdit}
              class="slds-m-top_x-small slds-m-bottom_x-small slds-float_right slds-m-right_small"
            ></lightning-button>
          </template>

          <template if:false={isEditOption}>
            <lightning-button
              label={label.add_option}
              class="slds-m-top_x-small slds-m-bottom_x-small slds-float_right"
              onclick={addOption}
            ></lightning-button>
          </template>
        </div>
      </div>
    </template>

    <hr class="slds-clearfix slds-m-bottom_x-small" />

    <template if:true={isDependentQuestion} class="slds-m-top_small">
      This question will be visible if {validationForForm.Related_Question__c.Label__c}

      <div class="slds-grid slds-wrap">
        <div class="slds-size_1-of-2">
          <lightning-combobox
            label={label.operator}
            value={validationForForm.Operator__c}
            placeholder={label.select_operator}
            options={displayedOperators}
            class="slds-m-right_small"
            onchange={setSelectedOperator}
          >
          </lightning-combobox>
        </div>

        <div class="slds-size_1-of-2">
          <lightning-combobox
            label={label.value}
            if:true={isFirstQuestionPicklist}
            placeholder={label.select_value}
            options={questionsOptions}
            class="slds-m-left_small validationInput"
            value={validationForForm.Value__c}
            required
          >
          </lightning-combobox>

          <lightning-input
            if:false={isFirstQuestionPicklist}
            type={inputType}
            label={label.enter_compared_value}
            class="slds-m-left_small validationInput"
            value={validationForForm.Value__c}
            required
          ></lightning-input>
        </div>
      </div>

      <hr class="slds-clearfix slds-m-bottom_x-small" />

    </template>

    <div class="slds-text-align_center modal_buttons">
      <template if:true={isEditMode}>
        <lightning-button
          variant="destructive"
          label={label.cancel_edit}
          class="slds-m-left_x-small"
          onclick={cancelQuestionEdit}
        >
        </lightning-button>

        <lightning-button
          variant="brand"
          label={label.save_changes}
          class="slds-m-left_x-small"
          onclick={updateQuestion}
        >
        </lightning-button>
      </template>

      <template if:false={isEditMode}>
        <lightning-button
          variant="brand"
          label={label.add_question}
          onclick={addQuestion}
        ></lightning-button>
      </template>
    </div>
  </div>
</template>